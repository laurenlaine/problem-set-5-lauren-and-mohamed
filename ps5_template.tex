% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Problem Set 5},
  pdfauthor={Lauren Laine and Mohamed Mohamed},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Problem Set 5}
\author{Lauren Laine and Mohamed Mohamed}
\date{Invalid Date}

\begin{document}
\maketitle

\RecustomVerbatimEnvironment{verbatim}{Verbatim}{
  showspaces = false,
  showtabs = false,
  breaksymbolleft={},
  breaklines
}


\textbf{Due 11/9 at 5:00PM Central. Worth 100 points + 10 points extra
credit.}

\subsection{Submission Steps (10 pts)}\label{submission-steps-10-pts}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  This problem set is a paired problem set.
\item
  Play paper, scissors, rock to determine who goes first. Call that
  person \emph{Partner 1}.

  \begin{itemize}
  \tightlist
  \item
    Partner 1 (name and cnet ID): Lauren Laine, llaine
  \item
    Partner 2 (name and cnet ID):
  \end{itemize}
\item
  Partner 1 will accept the \texttt{ps5} and then share the link it
  creates with their partner. You can only share it with one partner so
  you will not be able to change it after your partner has accepted.
\item
  ``This submission is our work alone and complies with the 30538
  integrity policy.'' Add your initials to indicate your agreement:
  **\_\_** **\_\_**
\item
  ``I have uploaded the names of anyone else other than my partner and I
  worked with on the problem set
  \textbf{\href{https://docs.google.com/forms/d/185usrCREQaUbvAXpWhChkjghdGgmAZXA3lPWpXLLsts/edit}{here}}''
  (1 point)
\item
  Late coins used this pset: **\_\_** Late coins left after submission:
  **\_\_**
\item
  Knit your \texttt{ps5.qmd} to an PDF file to make \texttt{ps5.pdf},

  \begin{itemize}
  \tightlist
  \item
    The PDF should not be more than 25 pages. Use \texttt{head()} and
    re-size figures when appropriate.
  \end{itemize}
\item
  (Partner 1): push \texttt{ps5.qmd} and \texttt{ps5.pdf} to your github
  repo.
\item
  (Partner 1): submit \texttt{ps5.pdf} via Gradescope. Add your partner
  on Gradescope.
\item
  (Partner 1): tag your submission in Gradescope
\end{enumerate}

\newpage

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ altair }\ImportTok{as}\NormalTok{ alt}
\ImportTok{import}\NormalTok{ time}

\ImportTok{import}\NormalTok{ warnings }
\NormalTok{warnings.filterwarnings(}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{)}
\NormalTok{alt.renderers.enable(}\StringTok{"png"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
RendererRegistry.enable('png')
\end{verbatim}

\subsection{Step 1: Develop initial scraper and
crawler}\label{step-1-develop-initial-scraper-and-crawler}

\subsubsection{1. Scraping (PARTNER 1)}\label{scraping-partner-1}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ requests}
\ImportTok{from}\NormalTok{ bs4 }\ImportTok{import}\NormalTok{ BeautifulSoup}
\NormalTok{url }\OperatorTok{=} \StringTok{\textquotesingle{}https://oig.hhs.gov/fraud/enforcement/\textquotesingle{}}
\NormalTok{response }\OperatorTok{=}\NormalTok{ requests.get(url)}
\NormalTok{soup }\OperatorTok{=}\NormalTok{ BeautifulSoup(response.text, }\StringTok{\textquotesingle{}lxml\textquotesingle{}}\NormalTok{)}
\NormalTok{soup.text[}\DecValTok{0}\NormalTok{:}\DecValTok{50}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEnforcement Actions | Office '
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# scrape title of the enforcement action }
\CommentTok{\# used ChatGPT to figure out the the class attribute is written as class\_}
\CommentTok{\#Prompt why won\textquotesingle{}t this code run : soup.find\_all(\textquotesingle{}h2\textquotesingle{}, class =\textquotesingle{}usa{-}card\_\_heading\textquotesingle{})}
\NormalTok{usa\_card\_\_heading}\OperatorTok{=}\NormalTok{soup.find\_all(}\StringTok{\textquotesingle{}h2\textquotesingle{}}\NormalTok{, class\_ }\OperatorTok{=}\StringTok{\textquotesingle{}usa{-}card\_\_heading\textquotesingle{}}\NormalTok{)}
\NormalTok{a\_tags}\OperatorTok{=}\NormalTok{[]}
\ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ usa\_card\_\_heading:}
\NormalTok{  a}\OperatorTok{=}\NormalTok{tag.find(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{).text}
\NormalTok{  a\_tags.append(a)}
\CommentTok{\#check and make sure all titles were collected}
\BuiltInTok{print}\NormalTok{(a\_tags[}\DecValTok{19}\NormalTok{]) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Quincy-Based Physician Group To Pay $650,000 To Resolve Allegations Of False Billing To MassHealth
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#scrape date}
\NormalTok{dates}\OperatorTok{=}\NormalTok{[]}
\NormalTok{soup\_dates}\OperatorTok{=}\NormalTok{soup.find\_all(}\StringTok{\textquotesingle{}span\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}text{-}base{-}dark padding{-}right{-}105\textquotesingle{}}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ soup\_dates:}
\NormalTok{  text}\OperatorTok{=}\NormalTok{tag.text}
\NormalTok{  dates.append(text)}
\BuiltInTok{print}\NormalTok{(dates[}\DecValTok{0}\NormalTok{:}\DecValTok{5}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(dates[}\DecValTok{19}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
['November 8, 2024', 'November 7, 2024', 'November 7, 2024', 'November 7, 2024', 'November 7, 2024']
October 30, 2024
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# scrape category}
\NormalTok{category}\OperatorTok{=}\NormalTok{[]}
\NormalTok{soup\_category}\OperatorTok{=}\NormalTok{soup.find\_all(}\StringTok{\textquotesingle{}li\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{"display{-}inline{-}block usa{-}tag text{-}no{-}lowercase text{-}base{-}darkest bg{-}base{-}lightest margin{-}right{-}1"}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ soup\_category:}
\NormalTok{  text}\OperatorTok{=}\NormalTok{tag.text}
\NormalTok{  category.append(text)}
\BuiltInTok{print}\NormalTok{(category[}\DecValTok{19}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
State Enforcement Agencies
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#scrape link associated with the enforecment action }
\NormalTok{hrefs}\OperatorTok{=}\NormalTok{[]}
\NormalTok{link\_tags}\OperatorTok{=}\NormalTok{[]}
\NormalTok{full\_links}\OperatorTok{=}\NormalTok{[]}
\ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ usa\_card\_\_heading:}
\NormalTok{  link\_tags.append(tag.find(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{).attrs)}

\ControlFlowTok{for}\NormalTok{ link }\KeywordTok{in}\NormalTok{ link\_tags:}
\NormalTok{  href}\OperatorTok{=}\NormalTok{link.get(}\StringTok{\textquotesingle{}href\textquotesingle{}}\NormalTok{)}
\NormalTok{  hrefs.append(href)}

\BuiltInTok{print}\NormalTok{(hrefs[}\DecValTok{19}\NormalTok{])}
\NormalTok{prefix}\OperatorTok{=}\StringTok{\textquotesingle{}https://oig.hhs.gov/\textquotesingle{}}
\ControlFlowTok{for}\NormalTok{ href }\KeywordTok{in}\NormalTok{ hrefs:}
\NormalTok{  link}\OperatorTok{=}\NormalTok{ prefix}\OperatorTok{+}\NormalTok{href}
\NormalTok{  full\_links.append(link)}

\BuiltInTok{print}\NormalTok{(full\_links)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
/fraud/enforcement/quincy-based-physician-group-to-pay-650000-to-resolve-allegations-of-false-billing-to-masshealth/
['https://oig.hhs.gov//fraud/enforcement/pharmacist-and-brother-convicted-of-15m-medicare-medicaid-and-private-insurer-fraud-scheme/', 'https://oig.hhs.gov//fraud/enforcement/boise-nurse-practitioner-sentenced-to-48-months-for-conspiracy-to-distribute-controlled-substances/', 'https://oig.hhs.gov//fraud/enforcement/former-traveling-nurse-pleads-guilty-to-tampering-with-morphine/', 'https://oig.hhs.gov//fraud/enforcement/former-arlington-resident-sentenced-to-prison-for-disclosing-healthcare-records-and-trying-to-cover-up-his-crimes/', 'https://oig.hhs.gov//fraud/enforcement/paroled-felon-sentenced-to-six-years-for-fraudulent-use-of-social-security-number-and-theft-of-benefits/', 'https://oig.hhs.gov//fraud/enforcement/former-licensed-counselor-sentenced-for-defrauding-medicaid/', 'https://oig.hhs.gov//fraud/enforcement/macomb-county-doctor-and-pharmacist-agree-to-pay-700948-to-settle-false-claims-act-allegations/', 'https://oig.hhs.gov//fraud/enforcement/rocky-hill-pharmacy-and-its-owners-indicted-for-conspiring-to-submit-false-pharmacy-claims-making-false-statements-and-aggravated-identity-theft/', 'https://oig.hhs.gov//fraud/enforcement/north-texas-medical-center-pays-142-million-to-resolve-potential-false-claims-act-liability-for-self-reported-violations-of-medicare-regs-stark-law/', 'https://oig.hhs.gov//fraud/enforcement/new-england-doctor-pleads-guilty-to-drug-distribution-conspiracy/', 'https://oig.hhs.gov//fraud/enforcement/attorney-general-alan-wilson-announces-upstate-woman-charged-with-stealing-thousands-of-dollars-from-vulnerable-adult/', 'https://oig.hhs.gov//fraud/enforcement/st-louis-county-woman-accused-of-3-million-home-health-care-fraud/', 'https://oig.hhs.gov//fraud/enforcement/lab-owner-and-marketing-company-owner-both-found-guilty-in-multi-million-dollar-medicare-and-medicaid-fraud-scheme/', 'https://oig.hhs.gov//fraud/enforcement/compound-ingredient-supplier-medisca-inc-to-pay-2175m-to-resolve-allegations-of-false-and-inflated-average-wholesale-prices-for-ingredients-used-in-compounded-prescriptions/', 'https://oig.hhs.gov//fraud/enforcement/the-new-mexico-department-of-justice-charges-former-new-mexico-state-police-officer-with-medicaid-fraud-identity-theft-and-practicing-medicine-without-a-license/', 'https://oig.hhs.gov//fraud/enforcement/nashville-woman-indicted-charged-in-tbi-medicaid-patient-abuse-case/', 'https://oig.hhs.gov//fraud/enforcement/michael-depalma-md-and-virginia-i-spine-physicians-agreed-to-pay-153000-for-allegedly-violating-the-civil-monetary-penalties-law-by-submitting-claims-for-services-that-exceeded-the-allowable-number-of-services/', 'https://oig.hhs.gov//fraud/enforcement/columbus-doctor-his-clinic-convicted-of-15-million-medicaid-scheme/', 'https://oig.hhs.gov//fraud/enforcement/mercy-health-youngstown-agreed-to-pay-69000-for-allegedly-violating-the-civil-monetary-penalties-law-by-contracting-with-an-excluded-individual/', 'https://oig.hhs.gov//fraud/enforcement/quincy-based-physician-group-to-pay-650000-to-resolve-allegations-of-false-billing-to-masshealth/']
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#create dataframe}
\NormalTok{df}\OperatorTok{=}\NormalTok{pd.DataFrame(\{}\StringTok{\textquotesingle{}Title\textquotesingle{}}\NormalTok{:a\_tags, }\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{:dates, }\StringTok{\textquotesingle{}Category\textquotesingle{}}\NormalTok{:category, }\StringTok{\textquotesingle{}Link\textquotesingle{}}\NormalTok{:full\_links\})}

\NormalTok{df.head()}
\BuiltInTok{len}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
20
\end{verbatim}

\subsubsection{2. Crawling (PARTNER 1)}\label{crawling-partner-1}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{url }\OperatorTok{=} \StringTok{\textquotesingle{}https://oig.hhs.gov/fraud/enforcement/washington{-}doctor{-}settles{-}allegations{-}he{-}submitted{-}false{-}claims{-}to{-}federal{-}health{-}care{-}programs/\textquotesingle{}}
\NormalTok{response }\OperatorTok{=}\NormalTok{ requests.get(url)}
\NormalTok{soup }\OperatorTok{=}\NormalTok{ BeautifulSoup(response.text, }\StringTok{\textquotesingle{}lxml\textquotesingle{}}\NormalTok{)}
\NormalTok{ul\_tag}\OperatorTok{=}\NormalTok{soup.find(}\StringTok{\textquotesingle{}ul\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{"usa{-}list usa{-}list{-}{-}unstyled margin{-}y{-}2"}\NormalTok{)}
\NormalTok{li\_list}\OperatorTok{=}\NormalTok{ul\_tag.find\_all(}\StringTok{\textquotesingle{}li\textquotesingle{}}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(li\_list)}
\BuiltInTok{print}\NormalTok{(li\_list[}\DecValTok{1}\NormalTok{])}
\CommentTok{\#used ChatGPT to figure out how to remove the span tag. }
\CommentTok{\# Prompt remove span tag and content with Beautiful Soup in Python }
\NormalTok{span\_tag }\OperatorTok{=}\NormalTok{ li\_list[}\DecValTok{1}\NormalTok{].find(}\StringTok{\textquotesingle{}span\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}padding{-}right{-}2 text{-}base\textquotesingle{}}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{ span\_tag:}
\NormalTok{    span\_tag.decompose()}
\BuiltInTok{print}\NormalTok{(li\_list[}\DecValTok{1}\NormalTok{].text)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[<li><span class="padding-right-2 text-base">Date:</span>October 25, 2024</li>, <li><span class="padding-right-2 text-base">Agency:</span>U.S. Attorney's Office, Western District of Washington</li>, <li>
<span class="padding-right-1 text-base">Enforcement Types:</span>
<ul class="usa-list usa-list--unstyled margin-top-0 display-inline-block">
<li class="display-inline">
                                            Criminal and Civil Actions
                                        </li>
</ul>
</li>, <li class="display-inline">
                                            Criminal and Civil Actions
                                        </li>]
<li><span class="padding-right-2 text-base">Agency:</span>U.S. Attorney's Office, Western District of Washington</li>
U.S. Attorney's Office, Western District of Washington
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{agencies}\OperatorTok{=}\NormalTok{[]}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{min}\NormalTok{(}\DecValTok{20}\NormalTok{, }\BuiltInTok{len}\NormalTok{(full\_links))):}
\NormalTok{  url }\OperatorTok{=}\NormalTok{ full\_links[i]}
\NormalTok{  response }\OperatorTok{=}\NormalTok{ requests.get(url)}
\NormalTok{  soup }\OperatorTok{=}\NormalTok{ BeautifulSoup(response.text, }\StringTok{\textquotesingle{}lxml\textquotesingle{}}\NormalTok{)}
\NormalTok{  ul\_tag}\OperatorTok{=}\NormalTok{soup.find(}\StringTok{\textquotesingle{}ul\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{"usa{-}list usa{-}list{-}{-}unstyled margin{-}y{-}2"}\NormalTok{)}
\NormalTok{  li\_list}\OperatorTok{=}\NormalTok{ul\_tag.find\_all(}\StringTok{\textquotesingle{}li\textquotesingle{}}\NormalTok{)}
\NormalTok{  span\_tag }\OperatorTok{=}\NormalTok{ li\_list[}\DecValTok{1}\NormalTok{].find(}\StringTok{\textquotesingle{}span\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}padding{-}right{-}2 text{-}base\textquotesingle{}}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ span\_tag:}
\NormalTok{    span\_tag.decompose()}
\NormalTok{  agency}\OperatorTok{=}\NormalTok{(li\_list[}\DecValTok{1}\NormalTok{].text)}
  \BuiltInTok{print}\NormalTok{(agency)}
\NormalTok{  agencies.append(agency)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
U.S. Department of Justice
November 7, 2024; U.S. Attorney's Office, District of Idaho
U.S. Attorney's Office, District of Massachusetts
U.S. Attorney's Office, Eastern District of Virginia
U.S. Attorney's Office, Middle District of Florida
U.S. Attorney's Office, Western District of Texas
U.S. Attorney's Office, Eastern District of Michigan
U.S. Attorney's Office, Eastern District of Tennessee
U.S. Attorney's Office, Northern District of Texas
U.S. Department of Justice
State of South Carolina
U.S. Attorney's Office, Eastern District of Missouri
U.S. Attorney's Office, Middle District of Tennessee
U.S. Department of Justice
State of New Mexico
State of Tennessee

Enforcement Types:


                                            CMP and Affirmative Exclusions
                                        


Ohio

Enforcement Types:


                                            Fraud Self-Disclosures
                                        


State of Massachusetts
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\StringTok{\textquotesingle{}Agency\textquotesingle{}}\NormalTok{]}\OperatorTok{=}\NormalTok{agencies}
\NormalTok{df.head()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllll@{}}
\toprule\noalign{}
& Title & Date & Category & Link & Agency \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & Pharmacist and Brother Convicted of \$15M Medic... & November 8,
2024 & Criminal and Civil Actions &
https://oig.hhs.gov//fraud/enforcement/pharmac... & U.S. Department of
Justice \\
1 & Boise Nurse Practitioner Sentenced To 48 Month... & November 7, 2024
& Criminal and Civil Actions &
https://oig.hhs.gov//fraud/enforcement/boise-n... & November 7, 2024;
U.S. Attorney\textquotesingle s Office, Dist... \\
2 & Former Traveling Nurse Pleads Guilty To Tamper... & November 7, 2024
& Criminal and Civil Actions &
https://oig.hhs.gov//fraud/enforcement/former-... & U.S.
Attorney\textquotesingle s Office, District of Massachusetts \\
3 & Former Arlington Resident Sentenced To Prison ... & November 7, 2024
& Criminal and Civil Actions &
https://oig.hhs.gov//fraud/enforcement/former-... & U.S.
Attorney\textquotesingle s Office, Eastern District of Vi... \\
4 & Paroled Felon Sentenced To Six Years For Fraud... & November 7, 2024
& Criminal and Civil Actions &
https://oig.hhs.gov//fraud/enforcement/paroled... & U.S.
Attorney\textquotesingle s Office, Middle District of Flo... \\
\end{longtable}

\subsection{Step 2: Making the scraper
dynamic}\label{step-2-making-the-scraper-dynamic}

\subsubsection{1. Turning the scraper into a
function}\label{turning-the-scraper-into-a-function}

\begin{itemize}
\tightlist
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi}.}
  \tightlist
  \item
    Pseudo-Code (PARTNER 2)
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi}.}
  \setcounter{enumi}{1}
  \tightlist
  \item
    Create Dynamic Scraper (PARTNER 2)
  \end{enumerate}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ requests}
\ImportTok{from}\NormalTok{ bs4 }\ImportTok{import}\NormalTok{ BeautifulSoup}
\ImportTok{from}\NormalTok{ datetime }\ImportTok{import}\NormalTok{ datetime}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ check\_input(year):}
    \ControlFlowTok{if}\NormalTok{ year }\OperatorTok{\textless{}} \DecValTok{2013}\NormalTok{:}
        \BuiltInTok{print}\NormalTok{(}\StringTok{"Please enter a year \textgreater{}= 2013, as only enforcement actions after 2013 are available."}\NormalTok{)}
        \ControlFlowTok{return} \VariableTok{False}
    \ControlFlowTok{return} \VariableTok{True}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ initialize\_data\_containers():}
  \ControlFlowTok{return}\NormalTok{ [], [], [], []}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ get\_today\_date():}
\NormalTok{    now }\OperatorTok{=}\NormalTok{ datetime.now()}
    \ControlFlowTok{return}\NormalTok{ now.year, now.month}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ get\_page\_content(url):}
\NormalTok{    response }\OperatorTok{=}\NormalTok{ requests.get(url)}
    \ControlFlowTok{return}\NormalTok{ BeautifulSoup(response.text, }\StringTok{\textquotesingle{}lxml\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ get\_titles(soup):}
\NormalTok{    titles }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    headings }\OperatorTok{=}\NormalTok{ soup.find\_all(}\StringTok{\textquotesingle{}h2\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}usa{-}card\_\_heading\textquotesingle{}}\NormalTok{)}
    \ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ headings:}
\NormalTok{        titles.append(tag.find(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{).text)}
    \ControlFlowTok{return}\NormalTok{ titles}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ get\_dates(soup):}
\NormalTok{    dates }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    date\_tags }\OperatorTok{=}\NormalTok{ soup.find\_all(}\StringTok{\textquotesingle{}span\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}text{-}base{-}dark padding{-}right{-}105\textquotesingle{}}\NormalTok{)}
    \ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ date\_tags:}
\NormalTok{        dates.append(tag.text)}
    \ControlFlowTok{return}\NormalTok{ dates}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ get\_categories(soup):}
\NormalTok{    categories }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    category\_tags }\OperatorTok{=}\NormalTok{ soup.find\_all(}\StringTok{\textquotesingle{}li\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{"display{-}inline{-}block usa{-}tag text{-}no{-}lowercase text{-}base{-}darkest bg{-}base{-}lightest margin{-}right{-}1"}\NormalTok{)}
    \ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ category\_tags:}
\NormalTok{        categories.append(tag.text)}
    \ControlFlowTok{return}\NormalTok{ categories}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ get\_links(soup):}
\NormalTok{    full\_links }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    link\_tags }\OperatorTok{=}\NormalTok{ [tag.find(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{).attrs }\ControlFlowTok{for}\NormalTok{ tag }\KeywordTok{in}\NormalTok{ soup.find\_all(}\StringTok{\textquotesingle{}h2\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}usa{-}card\_\_heading\textquotesingle{}}\NormalTok{)]}
\NormalTok{    prefix }\OperatorTok{=} \StringTok{\textquotesingle{}https://oig.hhs.gov/\textquotesingle{}}
    \ControlFlowTok{for}\NormalTok{ link }\KeywordTok{in}\NormalTok{ link\_tags:}
\NormalTok{        full\_links.append(prefix }\OperatorTok{+}\NormalTok{ link.get(}\StringTok{\textquotesingle{}href\textquotesingle{}}\NormalTok{))}
    \ControlFlowTok{return}\NormalTok{ full\_links}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ making\_dataframe(titles, dates, categories, links):}
    \ControlFlowTok{return}\NormalTok{ pd.DataFrame(\{}
        \StringTok{\textquotesingle{}Title\textquotesingle{}}\NormalTok{: titles,}
        \StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{: dates,}
        \StringTok{\textquotesingle{}Category\textquotesingle{}}\NormalTok{: categories,}
        \StringTok{\textquotesingle{}Link\textquotesingle{}}\NormalTok{: links}
\NormalTok{    \})}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ save\_to\_csv(df, start\_year, start\_month):}
\NormalTok{    filename }\OperatorTok{=} \SpecialStringTok{f"enforcement\_actions\_}\SpecialCharTok{\{}\NormalTok{start\_year}\SpecialCharTok{\}}\SpecialStringTok{\_}\SpecialCharTok{\{}\NormalTok{start\_month}\SpecialCharTok{:02d\}}\SpecialStringTok{.csv"}
\NormalTok{    df.to\_csv(filename, index}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Data saved to }\SpecialCharTok{\{}\NormalTok{filename}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ showing\_summary(df):}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Number of enforcement actions: }\SpecialCharTok{\{}\BuiltInTok{len}\NormalTok{(df)}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
    \ControlFlowTok{if} \KeywordTok{not}\NormalTok{ df.empty:}
\NormalTok{        earliest\_date }\OperatorTok{=}\NormalTok{ df[}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{].}\BuiltInTok{min}\NormalTok{()}
\NormalTok{        earliest\_action }\OperatorTok{=}\NormalTok{ df[df[}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{] }\OperatorTok{==}\NormalTok{ earliest\_date].iloc[}\DecValTok{0}\NormalTok{]}
        \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Earliest enforcement action Date {-} }\SpecialCharTok{\{}\NormalTok{earliest\_action[}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{]}\SpecialCharTok{\}}\SpecialStringTok{, Title {-} }\SpecialCharTok{\{}\NormalTok{earliest\_action[}\StringTok{\textquotesingle{}Title\textquotesingle{}}\NormalTok{]}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visited\_urls }\OperatorTok{=}\NormalTok{ []}

\KeywordTok{def}\NormalTok{ scrape\_enforcement\_actions(start\_year, start\_month):}
    \ControlFlowTok{if} \KeywordTok{not}\NormalTok{ check\_input(start\_year):}
        \ControlFlowTok{return}

\NormalTok{    titles, dates, categories, full\_links }\OperatorTok{=}\NormalTok{ initialize\_data\_containers()}
    
\NormalTok{    base\_url }\OperatorTok{=} \StringTok{\textquotesingle{}https://oig.hhs.gov/fraud/enforcement/\textquotesingle{}}
    
\NormalTok{    current\_year, current\_month }\OperatorTok{=}\NormalTok{ get\_today\_date()}
    
    
\NormalTok{    year, month }\OperatorTok{=}\NormalTok{ start\_year, start\_month}
    
    \ControlFlowTok{while}\NormalTok{ (year }\OperatorTok{\textless{}}\NormalTok{ current\_year) }\KeywordTok{or}\NormalTok{ (year }\OperatorTok{==}\NormalTok{ current\_year }\KeywordTok{and}\NormalTok{ month }\OperatorTok{\textless{}=}\NormalTok{ current\_month):}
        
\NormalTok{        url }\OperatorTok{=} \SpecialStringTok{f"}\SpecialCharTok{\{}\NormalTok{base\_url}\SpecialCharTok{\}}\SpecialStringTok{?year=}\SpecialCharTok{\{}\NormalTok{year}\SpecialCharTok{\}}\SpecialStringTok{\&month=}\SpecialCharTok{\{}\NormalTok{month}\SpecialCharTok{\}}\SpecialStringTok{"}
        \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Scraping data for }\SpecialCharTok{\{}\NormalTok{year}\SpecialCharTok{\}}\SpecialStringTok{{-}}\SpecialCharTok{\{}\NormalTok{month}\SpecialCharTok{:02d\}}\SpecialStringTok{ from }\SpecialCharTok{\{}\NormalTok{url}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
        
        \ControlFlowTok{if}\NormalTok{ url }\KeywordTok{in}\NormalTok{ visited\_urls:}
            \BuiltInTok{print}\NormalTok{(}\StringTok{"Stopped because ended up in a loop."}\NormalTok{)}
            \ControlFlowTok{break}

\NormalTok{        soup }\OperatorTok{=}\NormalTok{ get\_page\_content(url)}
        
\NormalTok{        titles.extend(get\_titles(soup))}
\NormalTok{        dates.extend(get\_dates(soup))}
\NormalTok{        categories.extend(get\_categories(soup))}
\NormalTok{        full\_links.extend(get\_links(soup))}

\NormalTok{        visited\_urls.append(url)}
        
\NormalTok{        time.sleep(}\DecValTok{2}\NormalTok{)  }
        
\NormalTok{        month }\OperatorTok{+=} \DecValTok{1}
        \ControlFlowTok{if}\NormalTok{ month }\OperatorTok{\textgreater{}} \DecValTok{12}\NormalTok{:}
\NormalTok{            month }\OperatorTok{=} \DecValTok{1}
\NormalTok{            year }\OperatorTok{+=} \DecValTok{1}
    
\NormalTok{    df }\OperatorTok{=}\NormalTok{ making\_dataframe(titles, dates, categories, full\_links)}
    
\NormalTok{    save\_to\_csv(df, start\_year, start\_month)}
\NormalTok{    showing\_summary(df)}
    
    \ControlFlowTok{return}\NormalTok{ df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ scrape(year, month):}
\NormalTok{    date\_string }\OperatorTok{=} \SpecialStringTok{f\textquotesingle{}}\SpecialCharTok{\{}\NormalTok{year}\SpecialCharTok{\}}\SpecialStringTok{{-}}\SpecialCharTok{\{}\NormalTok{month}\OperatorTok{+}\DecValTok{1}\SpecialCharTok{:02d\}}\SpecialStringTok{\textquotesingle{}}
\NormalTok{    set\_date }\OperatorTok{=}\NormalTok{ pd.to\_datetime(date\_string, }\BuiltInTok{format}\OperatorTok{=}\StringTok{\textquotesingle{}\%Y{-}\%m\textquotesingle{}}\NormalTok{)}

\NormalTok{    titles }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    dates }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    categories }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    full\_links }\OperatorTok{=}\NormalTok{ []}

    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{250}\NormalTok{):}
\NormalTok{        base }\OperatorTok{=} \StringTok{\textquotesingle{}https://oig.hhs.gov/fraud/enforcement/?page=\textquotesingle{}}
\NormalTok{        url }\OperatorTok{=} \SpecialStringTok{f\textquotesingle{}}\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}\{}\NormalTok{i}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}
\NormalTok{        response }\OperatorTok{=}\NormalTok{ requests.get(url)}
\NormalTok{        soup }\OperatorTok{=}\NormalTok{ BeautifulSoup(response.text, }\StringTok{\textquotesingle{}lxml\textquotesingle{}}\NormalTok{)}

\NormalTok{        body }\OperatorTok{=}\NormalTok{ soup.find(}\StringTok{\textquotesingle{}body\textquotesingle{}}\NormalTok{)}
\NormalTok{        soup\_dates }\OperatorTok{=}\NormalTok{ body.find\_all(}\StringTok{\textquotesingle{}span\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}text{-}base{-}dark padding{-}right{-}105\textquotesingle{}}\NormalTok{)}
\NormalTok{        soup\_titles }\OperatorTok{=}\NormalTok{ body.find\_all(}\StringTok{\textquotesingle{}h2\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{\textquotesingle{}usa{-}card\_\_heading\textquotesingle{}}\NormalTok{)}
\NormalTok{        soup\_category }\OperatorTok{=}\NormalTok{ body.find\_all(}\StringTok{\textquotesingle{}li\textquotesingle{}}\NormalTok{, class\_}\OperatorTok{=}\StringTok{"display{-}inline{-}block usa{-}tag text{-}no{-}lowercase text{-}base{-}darkest bg{-}base{-}lightest margin{-}right{-}1"}\NormalTok{)}

        \CommentTok{\# Ensure lengths match by iterating over all tags}
        \ControlFlowTok{for}\NormalTok{ date\_tag, title\_tag, category\_tag }\KeywordTok{in} \BuiltInTok{zip}\NormalTok{(soup\_dates, soup\_titles, soup\_category):}
            \CommentTok{\# Dates}
\NormalTok{            date }\OperatorTok{=}\NormalTok{ pd.to\_datetime(date\_tag.text, }\BuiltInTok{format}\OperatorTok{=}\StringTok{\textquotesingle{}\%B }\SpecialCharTok{\%d}\StringTok{, \%Y\textquotesingle{}}\NormalTok{)}
\NormalTok{            dates.append(date)}

            \CommentTok{\# Titles}
\NormalTok{            title }\OperatorTok{=}\NormalTok{ title\_tag.find(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{).text}
\NormalTok{            titles.append(title)}

            \CommentTok{\# Categories}
\NormalTok{            category }\OperatorTok{=}\NormalTok{ category\_tag.text.strip()}
\NormalTok{            categories.append(category)}

            \CommentTok{\# Links}
\NormalTok{            href }\OperatorTok{=}\NormalTok{ title\_tag.find(}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{).attrs.get(}\StringTok{\textquotesingle{}href\textquotesingle{}}\NormalTok{)}
\NormalTok{            full\_link }\OperatorTok{=} \SpecialStringTok{f\textquotesingle{}https://oig.hhs.gov/}\SpecialCharTok{\{}\NormalTok{href}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}
\NormalTok{            full\_links.append(full\_link)}

        \ControlFlowTok{if}\NormalTok{ date}\OperatorTok{\textless{}}\NormalTok{ set\_date:}
            \ControlFlowTok{break}
    
\NormalTok{    scraped\_data}\OperatorTok{=}\NormalTok{data}\OperatorTok{=}\NormalTok{pd.DataFrame(\{}\StringTok{\textquotesingle{}Title\textquotesingle{}}\NormalTok{:titles, }\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{:dates, }\StringTok{\textquotesingle{}Category\textquotesingle{}}\NormalTok{:category, }\StringTok{\textquotesingle{}Link\textquotesingle{}}\NormalTok{:full\_links\})}
    
    \ControlFlowTok{return}\NormalTok{ scraped\_data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Running scraper starting from January 2023}
\NormalTok{scraped }\OperatorTok{=}\NormalTok{ scrape(}\DecValTok{2023}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#df[\textquotesingle{}Date\textquotesingle{}]=pd.to\_datetime(df[\textquotesingle{}Date\textquotesingle{}])}
\NormalTok{df\_23}\OperatorTok{=}\NormalTok{scraped[scraped[}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{].dt.year}\OperatorTok{==}\DecValTok{2023}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi}.}
  \setcounter{enumi}{2}
  \tightlist
  \item
    Test Partner's Code (PARTNER 1)
  \end{enumerate}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_21}\OperatorTok{=}\NormalTok{scrape(}\DecValTok{2021}\NormalTok{, }\DecValTok{1}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_21.tail()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lllll@{}}
\toprule\noalign{}
& Title & Date & Category & Link \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
3015 & Assisted Living Facility Supervisor Arrested f... & 2021-01-25 &
State Enforcement Agencies &
https://oig.hhs.gov//fraud/enforcement/assiste... \\
3016 & Maryland Woman Sentenced for Committing Health... & 2021-01-22 &
State Enforcement Agencies &
https://oig.hhs.gov//fraud/enforcement/marylan... \\
3017 & Estate Of Deceased Urologist Agrees To Pay Mor... & 2021-01-22 &
State Enforcement Agencies &
https://oig.hhs.gov//fraud/enforcement/estate-... \\
3018 & Logan County Pharmacy to Pay Civil Monetary Pe... & 2021-01-22 &
State Enforcement Agencies &
https://oig.hhs.gov//fraud/enforcement/logan-c... \\
3019 & Attorney General Becerra Announces \$40 Million... & 2021-01-22 &
State Enforcement Agencies &
https://oig.hhs.gov//fraud/enforcement/attorne... \\
\end{longtable}

\subsection{Step 3: Plot data based on scraped
data}\label{step-3-plot-data-based-on-scraped-data}

\subsubsection{1. Plot the number of enforcement actions over time
(PARTNER
2)}\label{plot-the-number-of-enforcement-actions-over-time-partner-2}

\subsubsection{2. Plot the number of enforcement actions categorized:
(PARTNER
1)}\label{plot-the-number-of-enforcement-actions-categorized-partner-1}

\begin{itemize}
\item
  based on ``Criminal and Civil Actions'' vs.~``State Enforcement
  Agencies''
\item
  based on five topics
\end{itemize}

\subsection{Step 4: Create maps of enforcement
activity}\label{step-4-create-maps-of-enforcement-activity}

\subsubsection{1. Map by State (PARTNER
1)}\label{map-by-state-partner-1}

\subsubsection{2. Map by District (PARTNER
2)}\label{map-by-district-partner-2}

\subsection{Extra Credit}\label{extra-credit}

\subsubsection{1. Merge zip code shapefile with
population}\label{merge-zip-code-shapefile-with-population}

\subsubsection{2. Conduct spatial join}\label{conduct-spatial-join}

\subsubsection{3. Map the action ratio in each
district}\label{map-the-action-ratio-in-each-district}




\end{document}
